
(define (generate-primes)
    (define primes (array))
    (define candidate 2)
    (define (cannot-divide-candidate i)
        (% candidate i)
    )
    (lambda ()
        (define calculating TRUE)
        (while calculating
            (when (all cannot-divide-candidate primes)
                (append primes candidate)
                (define result candidate)
                (set calculating FALSE)
            )
            (= candidate (+ candidate 1))
        )
        result
    )
)

(define next-prime (generate-primes))

(for i (range 1 12)
    (print "Primes(" i ") = " (next-prime))
)

(quit)
