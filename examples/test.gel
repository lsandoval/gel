
(require Gtk "2.0")

( (. Gtk init) )

(def (object-add parent child)
    (object-set parent "child" child)
)

(def window (object-new (. Gtk Window)))

# window-title was defined in the interpreter
(object-set window "title" window-title)

(object-set window "default-width" 320)
(object-set window "default-height" 120)

(object-connect window "hide"
    (closure (widget)
        ( (. Gtk main-quit) )
    )
)

(def box (object-new (. Gtk VBox)))
(object-add window box)
(object-set box "border-width" 12)

# get-label-from-c was defined in the interpreter
(def label (get-label-from-c))
(object-add box label)

(def button (object-new (. Gtk Button)))
(object-add box button)
(object-set button "label" "Click me!")

(def entry (object-new (. Gtk Entry)))
(object-add box entry)

(def counter 0)

(object-connect button "clicked"
    (closure (widget)
        (print "Previous label " (. widget "label"))
        (object-set widget "label" "Thanks!")
        (set! counter (+ counter 1))
        (object-set entry "text" counter)
    )
)

(object-set label "visible" TRUE)
(object-set button "visible" TRUE)
(object-set entry "visible" TRUE)
(object-set box "visible" TRUE)
(object-set window "visible" TRUE)

( (. Gtk main) )

